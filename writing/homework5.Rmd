---
title: "R Programming, Homework 5"
author: "Heather Deel"
date: "11/6/2019"
output: html_document
---

# Global options
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Create of figure 
# Choice 1 - creation of map showing homicides of cities in 

# Read in libraries
```{r}
library(readr)
library(sf)
library(tigris)
library(forcats)
library(dplyr)
library(ggplot2)
```

# Load in the data and filter to Houston, TX
```{r}
homicides <- read_csv("../data/homicide-data.csv")
homicides <- homicides %>% 
  filter(city == "Houston")
```

Pick one city in the data. Create a map showing the locations of the homicides in that city, using the sf framework discussed in class. Use tigris to download boundaries for some sub-city geography (e.g., tracts, block groups, county subdivisions) to show as a layer underneath the points showing homicides. Use different facets for solved versus unsolved homicides and different colors to show the three race groups with the highest number of homicides for that city (you may find the fct_lump function from forcats useful for this).

## Figure generation (choice 1)
```{r}
# get tx counties
tx_counties <- counties(state = "TX", cb = TRUE, class = "sf")

# generate list of houston counties
houston_counties <- c("Austin", "Waller", "Montgomery", "Liberty", "Harris", "Fort Bend", "Brazoria", "Galveston", "Chambers")

# filter to houston counties
htx_counties <- tx_counties %>% 
  filter(NAME %in% houston_counties)

# filter out lat/lon NAs and change homicides to an sf object
homicides <- homicides %>% 
  filter(lat != "NA") %>% 
  filter(lon != "NA") %>% 
  gather(key = "key", value = "value") %>% 
  separate(key, c(""))
  st_as_sf(homicides, coords = c("lon", "lat")) %>% 
  st_set_crs()

# plot
#ggplot() +
  #geom_sf(data = htx_counties) +
  #geom_sf(data = homicides)

```




